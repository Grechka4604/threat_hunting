---
title: "Практическая работа №3"
author: "sokol46532@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Закрепить практические навыки работы с данными в языке программирования R  
2. Повторить базовые типы данных языка R  
3. Отработать на практике применение функций пакета `dplyr`: `select(), filter(), mutate(), arrange(), group_by()`

## Исходные данные

1. Программное обеспечение Windows 10
2. RStudio Desktop  
3. Интерпретатор языка R 4.5.2  

## Задание

Используя пакет dplyr, освоить базовые операции обработки данных в языке программирования R.

## Ход работы

1. Проанализировать встроенные в пакет nycflights13 наборы данных с помощью
языка R и ответить на вопросы:
    - Сколько встроенных в пакет nycflights13 датафреймов?
    - Сколько строк в каждом датафрейме?
    - Сколько столбцов в каждом датафрейме?
    - Как просмотреть примерный вид датафрейма?
    - Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?
    - Сколько рейсов принял аэропорт John F Kennedy Intl в мае?
    - Какой самый северный аэропорт?
    - Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?
    - Какие бортовые номера у самых старых самолетов?
    - Какая средняя температура воздуха была в сентябре в аэропорту John FKennedy Intl (в градусах Цельсия).
    - Самолеты какой авиакомпании совершили больше всего вылетов в июне?
    - Самолеты какой авиакомпании задерживались чаще других в 2013 году?
2. Оценить результаты и сделать вывод.

## Шаги:

### Шаг 1

Установим пакет nycflights13.

Подключим необходимые библиотеки
```{r}
library(nycflights13)
library(dplyr)
```
Сколько встроенных в пакет nycflights13 датафреймов?
```{r}
nrow(data(package = "nycflights13")$results)
```
Сколько строк в каждом датафрейме?
```{r}
sapply(
list(
airlines = airlines,
airports = airports,
flights  = flights,
planes   = planes,
weather  = weather
),
nrow
)
```
Сколько столбцов в каждом датафрейме?
```{r}
sapply(
list(
airlines = airlines,
airports = airports,
flights  = flights,
planes   = planes,
weather  = weather
),
ncol
)
```
Как просмотреть примерный вид датафрейма?
```{r}
airlines %>%
as_tibble() %>%
head()

```
Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?
```{r}
airlines %>%
summarise(unique_carriers = n_distinct(carrier)) %>%
pull(unique_carriers)
```
Сколько рейсов принял аэропорт John F Kennedy Intl в мае?
```{r}
flights %>%
filter(dest == "JFK", month == 5) %>%
tally() %>%
pull(n)
```
Какой самый северный аэропорт?
```{r}
airports %>%
filter(!is.na(lat)) %>%
slice_max(lat, n = 1, with_ties = FALSE) %>%
select(name, lat)

```

Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?
```{r}
airports %>%
filter(!is.na(alt)) %>%
slice_max(alt, n = 1, with_ties = FALSE) %>%
select(name, alt)
```

Какие бортовые номера у самых старых самолетов?
```{r}
planes %>%
filter(!is.na(year)) %>%
slice_min(year, n = 10, with_ties = TRUE) %>%
select(year, tailnum)

```
Какая средняя температура воздуха была в сентябре в аэропорту John FKennedy Intl (в градусах Цельсия).
```{r}
weather %>%
filter(origin == "JFK", month == 9) %>%
summarise(
mean_temp_c = (mean(temp, na.rm = TRUE) - 32) * 5 / 9
) %>%
pull(mean_temp_c)
```
Самолеты какой авиакомпании совершили больше всего вылетов в июне?
```{r}
flights %>%
filter(month == 6) %>%
group_by(carrier) %>%
summarise(flights_count = n(), .groups = "drop") %>%
arrange(desc(flights_count)) %>%
slice_head(n = 1) %>%
left_join(airlines, by = "carrier") %>%
select(name, flights_count)
```
Самолеты какой авиакомпании задерживались чаще других в 2013 году?
```{r}
flights %>%
filter(!is.na(dep_delay), !is.na(arr_delay)) %>%
mutate(delayed = dep_delay > 0 | arr_delay > 0) %>%
group_by(carrier) %>%
summarise(
delayed_flights = sum(delayed),
total_flights   = n(),
delay_ratio     = delayed_flights / total_flights,
.groups = "drop"
) %>%
arrange(desc(delay_ratio)) %>%
left_join(airlines, by = "carrier")

```
### Шаг 2
#### Оценка результатов

В процессе выполнения практической работы были отработаны навыки использования языка R для анализа и обработки табличных данных на примере наборов данных пакета nycflights13.

#### Вывод

Мы закрепили умение применять функции пакета dplyr для обработки данных (select(), filter(), mutate(), arrange(), group_by()) и научились использовать их для решения практических задач анализа данных.