---
title: "Практическая работа №2"
author: "sokol46532@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Развить практические навыки использования языка программирования R для обработки данных
2. Закрепить знания базовых типов данных языка R
3. Развить практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by()

## Исходные данные

1. Программное обеспечение Microsoft Windows 11 Pro
2. RStudio Desktop
3. Интерпретатор языка R 4.5.2

## Задание

Проанализировать встроенный в пакет dplyr набор данных starwars с помощью языка R и ответить на вопросы

## Ход работы

1. Проанализировать встроенный в пакет dplyr набор данных starwars с помощью языка R и ответить на вопросы:
    - Сколько строк в датафрейме?
    - Сколько столбцов в датафрейме?
    - Как просмотреть примерный вид датафрейма?
    - Сколько уникальных рас персонажей (species) представлено в данных?
    - Найти самого высокого персонажа.
    - Найти всех персонажей ниже 170
    - Подсчитать ИМТ (индекс массы тела) для всех персонажей.
    - Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по отношению массы (mass) к росту (height) персонажей
    - Найти средний возраст персонажей каждой расы вселенной Звездных войн
    - Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.
    - Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.
2. Оценить результаты и сделать вывод

## Шаги:

### Шаг №1

Установка пакета dplyr и загрузка набора данных starwars
```{r}
library(dplyr)
starwars_data <- starwars
```
Сколько строк в датафрейме?
```{r}
nrow(starwars_data)
```

Сколько столбцов в датафрейме?
```{r}
ncol(starwars_data)
```
Как просмотреть примерный вид датафрейма?
```{r}
glimpse(starwars_data)
```

Сколько уникальных рас персонажей (species) представлено в данных?
```{r}
starwars_data %>% pull(species) %>% unique() %>% length()
```
Найти самого высокого персонажа.
```{r}
starwars_data %>% filter(!is.na(height)) %>% slice_max(height, n = 1, with_ties = FALSE) %>% pull(name)
```
Найти всех персонажей ниже 170

    > starwars_data %>%
    +     filter(!is.na(height), height < 170) %>%
    +     select(name, height)
    # A tibble: 22 × 2
       name                  height
       <chr>                  <int>
     1 C-3PO                    167
     2 R2-D2                     96
     3 Leia Organa              150
     4 Beru Whitesun Lars       165
     5 R5-D4                     97
     6 Yoda                      66
     7 Mon Mothma               150
     8 Wicket Systri Warrick     88
     9 Nien Nunb                160
    10 Watto                    137
    # ℹ 12 more rows
    # ℹ Use `print(n = ...)` to see more rows

Подсчитать ИМТ (индекс массы тела) для всех персонажей.
```{r}
starwars_data %>%
pull(species) %>%
unique() %>%
length()
```

```{r}
starwars_data %>% filter(!is.na(height)) %>% slice_max(height, n = 1, with_ties = FALSE) %>% pull(name)
```
```{r}
starwars_data %>%
filter(!is.na(height), height < 170) %>%
select(name, height)
```
```{r}
starwars_data %>%
mutate(
bmi = mass / ( (height / 100)^2 )
) %>%
select(name, mass, height, bmi)
```

Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по
отношению массы (mass) к росту (height) персонажей
```{r}
starwars_data %>%
mutate(stretch_ratio = mass / height) %>%
filter(!is.na(stretch_ratio)) %>%
arrange(desc(stretch_ratio)) %>%
slice_head(n = 10) %>%
select(name, mass, height, stretch_ratio)
```

Найти средний возраст персонажей каждой расы вселенной Звездных войн
```{r}
starwars_data %>%
mutate(age = 100 + birth_year) %>%
filter(!is.na(age), !is.na(species)) %>%
group_by(species) %>%
summarise(
average_age = mean(age, na.rm = TRUE),
count = n()
) %>%
arrange(desc(average_age))
```
Найти самый распространенный цвет глаз персонажей вселенной Звездных
войн.
```{r}
starwars_data %>%
filter(!is.na(eye_color)) %>%
count(eye_color, sort = TRUE) %>%
slice_max(n, n = 1) %>%
pull(eye_color)
```

Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.
```{r}
starwars_data %>%
mutate(name_length = nchar(name)) %>%
filter(!is.na(species)) %>%
group_by(species) %>%
summarise(
avg_name_length = mean(name_length, na.rm = TRUE),
count = n()
) %>%
arrange(desc(avg_name_length))
```

## Шаг №2

### Оценка результатов

В ходе выполнения практической работы были отработаны навыки
использования языка R для анализа и обработки табличных данных, а также
изучены особенности набора данных starwars.

### Вывод

В результате работы мы закрепили применение базовых функций пакета dplyr
для обработки данных: select(), filter(), mutate(), arrange(),
group_by(), и научились использовать их на реальном примере.
